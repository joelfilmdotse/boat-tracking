<!DOCTYPE html>
<html>
<head>
  <title>Båtspårning</title>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAQPgoebWqFXyHmBYUPDd8-tRI170wyoJs"></script>
  <script>
    let map;
    let boats = {}; // Hållare för båtarnas markörer och historik

    // Initiera kartan
    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 57.60826637913071, lng: 11.796081624745197 }, // Vind i seglen koordinater
        zoom: 10,
      });

      // Hämta GPS-data varje sekund
      setInterval(updateBoatPositions, 1000);
    }

    // Uppdatera båtarnas positioner
    function updateBoatPositions() {
      // Exempeldata: Detta ska ersättas med data från din server eller Google Sheet
      const gpsData = [
        { id: "boat1", lat: 57.60800774112793, lng: 11.796280108211562, speed: 5 },
        { id: "boat2", lat: 57.60826206851243, lng: 11.796937249417766, speed: 6 },
      ];

      gpsData.forEach((boat) => {
        if (boats[boat.id]) {
          // Uppdatera markörens position
          boats[boat.id].marker.setPosition(new google.maps.LatLng(boat.lat, boat.lng));
          
          // Lägg till historiklinje
          const path = boats[boat.id].path.getPath();
          path.push(new google.maps.LatLng(boat.lat, boat.lng));
        } else {
          // Skapa en ny markör för båten
          boats[boat.id] = {
            marker: new google.maps.Marker({
              position: { lat: boat.lat, lng: boat.lng },
              map: map,
              title: boat.id,
              icon: {
                url: "https://img.icons8.com/emoji/48/sailboat-emoji.png", // Anpassa med din egen ikon
                scaledSize: new google.maps.Size(32, 32),
              },
            }),
            path: new google.maps.Polyline({
              map: map,
              strokeColor: "#FF0000",
              strokeOpacity: 1.0,
              strokeWeight: 2,
            }),
          };
        }
      });
    }
  </script>
</head>
<body onload="initMap()">
  <div id="map" style="width: 100%; height: 100vh;"></div>
</body>
</html>
